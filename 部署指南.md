# 医院预约挂号系统 - 完整部署指南

## 📦 项目打包与交付清单

### 1. 项目交付文件清单
```
Hospital/
├── backend/                              # 后端源码
│   ├── src/main/resources/
│   │   └── application.properties        # ⚠️ 后端配置文件（需要修改）
│   └── pom.xml
├── frontend/                             # 前端源码
│   ├── src/
│   └── package.json
├── init_hospital_db.sql                  # 数据库初始化脚本
├── 部署指南.md                           # 本文件
├── README.md                             # 项目说明
├── 账号密码.txt                           # 默认账号信息
└── 其他文档...
```

---

## 🎯 重要说明

### ⚠️ 关于数据库的重要说明
**每个部署者都需要在自己的电脑上安装并运行自己的 MySQL 数据库！**

- ❌ **不需要**连接到你的数据库
- ✅ **需要**在自己的电脑上安装 MySQL
- ✅ **需要**使用提供的 `init_hospital_db.sql` 初始化数据库
- ✅ **需要**修改配置文件中的数据库连接信息为自己的

### 📄 关于配置文件的说明

**后端配置文件位置：**
- 文件路径：`backend/src/main/resources/application.properties`
- 这是项目自带的配置文件，已经配置好了大部分内容
- **唯一需要修改的**：数据库密码（`spring.datasource.password`）

**不需要额外创建配置文件！** 直接修改项目中已有的配置文件即可。

---

## 📋 部署前的准备工作

### 1. 环境要求

部署者需要在自己的电脑上安装以下软件：

| 软件 | 版本要求 | 下载地址 | 用途 |
|------|---------|---------|------|
| **JDK** | Java 21 | https://www.oracle.com/java/technologies/downloads/ | 运行后端 |
| **Maven** | 3.8+ | https://maven.apache.org/download.cgi | 构建后端项目 |
| **Node.js** | 16+ | https://nodejs.org/ | 运行前端 |
| **MySQL** | 8.0+ | https://dev.mysql.com/downloads/mysql/ | 数据库 |

### 2. 验证安装
安装完成后，在命令行中验证：
```bash
# 验证 Java
java -version
# 应显示：java version "21.x.x"

# 验证 Maven
mvn -v
# 应显示：Apache Maven 3.x.x

# 验证 Node.js
node -v
# 应显示：v16.x.x 或更高

# 验证 MySQL
mysql --version
# 应显示：mysql Ver 8.0.x
```

---

## 🚀 部署步骤

### 步骤 1：从 GitHub 克隆项目

**⚠️ 重要：项目只能通过 GitHub 获取！**

```bash
git clone https://github.com/BUBUbaobao/hospital-management-system.git
cd hospital-management-system
```

**如果没有安装 Git：**
1. 下载并安装 Git：https://git-scm.com/downloads
2. 安装完成后重启命令行
3. 执行上述克隆命令

**如果克隆速度慢：**
可以使用镜像地址（如果有的话）或者配置 Git 代理。

---

### 步骤 2：配置并启动 MySQL 数据库

#### 2.1 启动 MySQL 服务
```bash
# Windows（在服务中启动，或使用命令）
net start MySQL80

# Mac/Linux
sudo systemctl start mysql
# 或
sudo service mysql start
```

#### 2.2 创建数据库并初始化
```bash
# 方式 1：命令行
mysql -u root -p < init_hospital_db.sql
# 输入你自己的 MySQL root 密码

# 方式 2：使用 MySQL Workbench 或 Navicat
# 1. 打开工具，连接到本地 MySQL
# 2. 打开 init_hospital_db.sql 文件
# 3. 执行脚本
```

#### 2.3 验证数据库创建成功
```bash
mysql -u root -p
# 输入密码后

mysql> USE hospital;
mysql> SHOW TABLES;
# 应该看到 12 张表：patients, doctors, admins, departments 等

mysql> SELECT * FROM admins;
# 应该看到一条管理员记录：admin
```

---

### 步骤 3：配置后端

#### 3.1 找到配置文件
配置文件位置：`backend/src/main/resources/application.properties`

#### 3.2 修改数据库配置

**⚠️ 重要：这是唯一需要修改的配置文件！**

打开 `backend/src/main/resources/application.properties`，找到数据库配置部分：

```properties
# Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/hospital?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=jyh20050820        # ⚠️ 改成你自己的 MySQL 密码
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
```

**必须修改的内容：**
- ✏️ `spring.datasource.password=jyh20050820` → 改为你自己的 MySQL root 密码

**可选修改（通常不需要）：**
- 如果你的 MySQL 用户名不是 `root`，修改 `spring.datasource.username`
- 如果你的 MySQL 端口不是 `3306`，修改 URL 中的端口号

**其他配置保持不变即可！**

#### 3.3 构建并启动后端
```bash
cd backend

# 清理并编译
mvn clean install -DskipTests

# 启动后端服务
mvn spring-boot:run
```

成功启动后，你会看到：
```
Started HospitalApplication in X.XXX seconds
```

后端服务运行在：**http://localhost:8080**

---

### 步骤 4：配置并启动前端

#### 4.1 安装依赖
```bash
cd frontend

# 安装依赖（首次运行需要，可能需要几分钟）
npm install
```

#### 4.2 启动前端
```bash
npm start
```

成功启动后，浏览器会自动打开：**http://localhost:3000**

---

### 步骤 5：测试登录

#### 测试管理员账号
- 账号：`admin`
- 密码：`admin123`

#### 测试患者账号
1. 在登录页点击"患者注册"
2. 填写信息并注册
3. 使用注册的账号登录

#### 测试医生账号
1. 先用管理员账号登录
2. 在"医生管理"页面添加医生
3. 使用医生账号 + 密码 + 校验码 `Doctor` 登录

---

## 🔧 常见问题与解决方案

### 问题 1：Git 克隆失败或速度慢
**原因**：网络问题或 Git 未安装

**解决**：
1. **确认 Git 已安装**：运行 `git --version`，如果提示未找到命令，需要先安装 Git
2. **网络问题**：
   - 检查网络连接是否正常
   - 尝试使用 VPN 或代理
   - 如果速度太慢，多试几次
3. **权限问题**：确保对目标文件夹有写入权限

---

### 问题 2：后端启动失败 - "Access denied for user"
**原因**：数据库密码配置错误

**解决**：
1. 检查 `application.properties` 中的密码是否正确
2. 确认 MySQL 用户名和密码
3. 尝试在命令行连接测试：`mysql -u root -p`

---

### 问题 3：前端无法访问后端 - "Network Error"
**原因**：后端未启动或端口被占用

**解决**：
1. 确认后端已成功启动（查看控制台输出）
2. 确认后端运行在 8080 端口
3. 检查防火墙是否阻止了 8080 端口

---

### 问题 4：数据库初始化失败
**原因**：数据库已存在或 SQL 语法错误

**解决**：
```bash
# 删除已存在的数据库
mysql -u root -p
mysql> DROP DATABASE IF EXISTS hospital;
mysql> exit;

# 重新执行初始化脚本
mysql -u root -p < init_hospital_db.sql
```

---

### 问题 5：端口被占用
**解决**：

**修改后端端口**：
编辑 `application.properties`：
```properties
server.port=8081  # 改为其他端口
```

**修改前端端口**：
编辑 `frontend/package.json`：
```json
"scripts": {
  "start": "set PORT=3001 && react-scripts start"  // Windows
  "start": "PORT=3001 react-scripts start"         // Mac/Linux
}
```

---

### 问题 6：Maven 下载依赖慢
**解决**：配置国内镜像

编辑 Maven 的 `settings.xml`：
```xml
<mirrors>
  <mirror>
    <id>aliyun</id>
    <mirrorOf>central</mirrorOf>
    <url>https://maven.aliyun.com/repository/public</url>
  </mirror>
</mirrors>
```

---

## 📝 配置文件说明

### 后端配置文件：application.properties
```properties
# 应用配置
spring.application.name=hospital-backend
server.port=8080

# 数据库配置（需要修改）
spring.datasource.url=jdbc:mysql://localhost:3306/hospital?...
spring.datasource.username=root
spring.datasource.password=你的密码

# JPA 配置
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# JWT 配置
jwt.secret=your-secret-key-at-least-256-bits...
jwt.expiration=86400000
```

### 前端 API 配置：http.js
前端默认访问 `http://localhost:8080/api/v1`
如果修改了后端端口，需要修改 `frontend/src/services/http.js`：
```javascript
const http = axios.create({
  baseURL: 'http://localhost:8081/api/v1',  // 修改端口
  timeout: 10000,
});
```

---

## 🌟 部署检查清单

部署完成后，按以下清单验证：

- [ ] MySQL 服务已启动
- [ ] 数据库 `hospital` 已创建
- [ ] 12 张表已创建成功
- [ ] 管理员账号存在（admin/admin123）
- [ ] 后端服务已启动（http://localhost:8080）
- [ ] 前端页面已打开（http://localhost:3000）
- [ ] 能够使用管理员账号登录
- [ ] 能够注册患者账号
- [ ] 能够添加医生并登录

---

## 🎓 给接收项目的人的建议

### 首次部署建议
1. **按顺序操作**：先装软件 → 配数据库 → 启后端 → 启前端
2. **遇到问题先看日志**：控制台的错误信息很有用
3. **不要跳过验证步骤**：每一步都验证成功再继续
4. **修改配置要重启**：改了配置文件要重启服务才生效

### 学习建议
- 熟悉 Spring Boot 和 React 基础
- 了解 RESTful API 设计
- 学习 MySQL 基本操作
- 阅读项目文档：`需求说明书.md`、`技术架构说明.md`

---

## 📚 相关文档

| 文档 | 说明 |
|------|------|
| `README.md` | 项目总览 |
| `需求说明书.md` | 详细功能需求 |
| `技术架构说明.md` | 技术选型和 API 文档 |
| `MySQL数据库设计.md` | 数据库设计详情 |
| `账号密码.txt` | 默认账号信息 |

---

## 📞 技术支持

如有问题，请：
1. 查看本部署指南的"常见问题"部分
2. 查看项目 README.md
3. 查看控制台的错误日志
4. 检查 GitHub 仓库的 Issues：https://github.com/BUBUbaobao/hospital-management-system/issues

---

## ✅ 部署完成

恭喜你完成部署！现在可以：
- 使用管理员账号登录体验系统
- 注册患者账号进行预约
- 添加医生并设置在岗时段
- 完整体验预约挂号流程

**祝使用愉快！🎉**

