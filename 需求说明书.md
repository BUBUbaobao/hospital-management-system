## 医院患者预约挂号系统 - 需求说明书

文档版本：v1.1  
编制日期：2025-10-31  
最后更新：2025-11-08  
适用范围：项目全体成员（产品、设计、前后端、测试、运维）

---

## 1. 概述
本系统面向大型医院，提供覆盖全院科室的预约挂号能力，缓解“挂号难、排队久”的问题，提高医疗资源利用效率。系统包含患者端、医生端与管理端，支持多角色登录与差异化功能。

## 2. 目标与量化指标
- **准确率目标**：预约挂号准确率 ≥ 98%
- **效率目标**：患者预约平均等待时间缩短 ≥ 50%
- **体验目标**：上线后稳定运行、无明显卡顿和错误；数据实时同步、一致性可靠

## 3. 角色与权限
| 角色 | 登录方式 | 权限范围 | 备注 |
| --- | --- | --- | --- |
| 患者 | 账号密码（可注册） | 注册、登录、查询可预约、预约/退号改签、查看提醒与就诊记录、评价、管理个人信息、退出 | 仅患者可注册，真实姓名作为系统昵称 |
| 医生 | 账号密码 + 校验码 `Doctor`（不可注册） | 设置在岗/不在岗、查看预约和对应预约记录的患者信息、会诊与完成就诊、管理个人信息及擅长科室、退出 | 不在岗不可被预约；在岗可被预约 |
| 管理员 | 固定账号 `admin`/`admin123`（不可注册） | 科室管理、医生管理（增/改状态/删）、统计分析、评分查看与排行、预约与就诊信息查看、退出 | 唯一管理员账号 |

## 4. 用例清单
| 编号 | 用例名称 | 参与者 | 触发条件 | 结果 |
| --- | --- | --- | --- | --- |
| UC-01 | 患者注册 | 患者 | 填写账号、密码、确认密码、手机号(11位)、真实姓名 | 注册成功，姓名作为系统昵称 |
| UC-02 | 患者登录 | 患者 | 输入账号密码 | 登录患者端 |
| UC-03 | 查询可预约 | 患者 | 选择科室/医生/就诊时间 | 返回可预约时段与医生 |
| UC-04 | 预约挂号 | 患者 | 在可预约范围内(1-7天)发起预约 | 生成预约记录(状态：待就诊) |
| UC-05 | 退号/改签 | 患者 | 在“我的预约”选择记录 | 状态改为已退号，或更新预约信息 |
| UC-06 | 就诊提醒查看 | 患者 | 临近就诊时间 | 在“我的预约”看到提醒 |
| UC-07 | 查看就诊记录详情 | 患者 | 就诊完成后 | 记录含科室、医生、时间、费用、医生建议 |
| UC-08 | 医生/科室评价 | 患者 | 就诊完成后 | 按 1-10 分进行评分 |
| UC-09 | 管理个人信息 | 患者 | 进入个人信息页 | 可维护年龄/身高/体重、上传头像 |
| UC-10 | 医生登录 | 医生 | 账号密码 + 校验码 Doctor | 登录医生端 |
| UC-11 | 设置在岗时段 | 医生 | 设置时间段 | 在岗可被预约，不在岗不可预约 |
| UC-12 | 查看预约与患者信息 | 医生 | 有患者预约 | 查看姓名、年龄、病情描述等 |
| UC-13 | 会诊并完成就诊 | 医生 | 待就诊记录 | 填写建议，状态变更为已就诊 |
| UC-14 | 科室管理 | 管理员 | 进入科室管理页 | 新增/修改描述/删减科室 |
| UC-15 | 医生管理 | 管理员 | 进入医生管理页 | 新增医生、修改在岗状态、删除医生 |
| UC-16 | 数据统计分析 | 管理员 | 仪表盘显示 | 查看医生数与在岗情况、每日预约/就诊数据 |
| UC-17 | 评分与排行 | 管理员 | 仪表盘显示 | 查看科室与医生评分及排行 |
| UC-18 | 查看预约/就诊信息 | 管理员 | 进入预约和就诊信息管理页 | 查看患者与医生信息及记录 |
| UC-19 | 管理员登录 | 管理员 | 输入固定账号密码 | 登录管理端 |
| UC-20 | 退出系统 | 所有角色 | 点击退出 | 结束会话，下次需重新登录 |

## 5. 业务流程（概要）
- **患者预约流程**：登录 → 查询（科室/医生/时间）→ 选择医生与时段 → 填写病情描述 → 提交预约（1-7 天内）→ 待就诊 → 就诊提醒 → 完成就诊 → 生成就诊记录 → 可评价
- **退号/改签流程**：我的预约 → 选择记录 → 退号（状态变更为已退号）或改签 → 更新记录
- **医生会诊流程**：登录（含校验码）→ 设置在岗时段 → 查看预约与患者信息 → 会诊（填写建议）→ 完成（预约状态改为已就诊）
- **科室/医生管理流程**（管理员）：科室新增/删减/描述维护；医生新增（账号、密码、姓名、擅长科室、头像）、修改在岗、不在岗、删除（物理删除）

## 6. 功能需求拆分
### 6.1 认证与会话
- 三端入口：患者登录/注册、医生登录（含校验码 Doctor）、管理员登录（固定账号/密码）
- 会话：本地项目，关闭重开需重新登录

### 6.2 患者端
1) 登录/注册：
   - 注册字段：账号、密码、确认密码、手机号（11 位校验）、真实姓名（作为昵称）
2) 查询与预约：
   - 按科室类型、医生名称、就诊时间查询可预约情况
   - 预约流程：先选科室 → 选医生 → 选时间 → 填写病情描述；可提前 1-7 天
3) 预约管理：
   - 我的预约：支持退号；临近就诊时间显示提醒
   - 完成就诊后，预约记录状态切为已就诊，并在“我的就诊情况”生成就诊记录（含科室、医生、时间、费用、医生建议）
4) 评价：
   - 每次就诊后可对医生与科室评分（1-10 分）
5) 个人信息：
   - 基础信息维护：姓名（注册真实姓名）、可补全年龄/身高/体重（选填）、头像上传（本地文件）
6) 退出系统

### 6.3 医生端
1) 登录：账号密码 + 校验码 `Doctor`
2) 在岗设置：
   - 自由设置在岗/不在岗时段；不在岗依然可被查询到，但不可被预约
3) 预约/患者信息：
   - “我的预约”可查看记录与“详情”，包括患者姓名、年龄、病情描述
4) 会诊：
   - 待就诊 → 点击“会诊” → 填写医生建议→ 完成（记录状态：已就诊）
   - 若患者已退号（状态：已退号）则不可就诊
5) 个人信息与擅长科室：
   - 从已有科室中选择；若科室被删除，医生擅长科室信息同步修改
6) 预约入口方式支持：
   - 方式一：按科室选医生再预约
   - 方式二：按医生查看其就诊科室再预约
7) 退出系统

### 6.4 管理端
1) 科室管理：
   - 初始科室：儿科、口腔科、内科、外科（可删减）
   - 新增科室（名称、描述）、删除科室、维护描述
2) 医生管理：
   - 新增医生（账号、密码、姓名、擅长科室、头像；与医生登录数据同步）
   - 修改医生状态（在岗/不在岗）
   - 删除医生（永久删除）
3) 数据统计与可视化：
   - 医生数量与在岗情况、每日预约/就诊数据
4) 评分与排行：
   - 按科室、医生评分查询；生成排行
5) 预约与就诊信息查询：
   - 可查看患者与医生个人信息（合规范围内）
6) 管理员登录：唯一账号 `admin`/`admin123`
7) 退出系统

## 7. 非功能需求
### 7.1 性能
- 页面交互流畅，无明显卡顿；操作无前端报错
- 数据写入/读取后端与数据库时，状态更新对前端实时可见或准实时（事件驱动/轮询）

### 7.2 安全与隐私
- 患者医疗数据严格保密，遵循医疗隐私法规
- 访问权限分级，限制越权访问；后端做鉴权与鉴别
- 管理员与医生无法自行注册；患者仅能操作本人数据

## 8. 系统与技术栈
- 前端：React + JavaScript
- 后端：Java 21
- 数据库：MySQL 8.0（需要修改配置文件中的密码为自己的 MySQL 密码）
- 部署/运行：本地开发运行测试；应用关闭重开需重新登录

## 9. 数据模型建议（概要）
- 用户（患者）User：id，account，password，realName，phone，age?，height?，weight?，avatarUrl?
- 医生 Doctor：id，account，password，name，status{在岗|不在岗}，departments[]，avatarUrl?
- 管理员 Admin：id，account(固定 admin)，password(固定 admin123)
- 科室 Department：id，name，description，enabled
- 在岗时段 Schedule：id，doctorId，startAt，endAt，status{在岗|不在岗}
- 预约 Appointment：id，patientId，doctorId，departmentId，doctorName，departmentName，visitAt，status{待就诊|已就诊|已退号}，illnessDesc
- 就诊记录 Visit：id，patientId，doctorId，departmentId，visitAt，appointmentId，totalFee，doctorAdvice，status{已完成|已取消}，medsServices[]
- 评价 Review：id，patientId，doctorId?，departmentId?，target{DOCTOR|DEPARTMENT}，visitId?，score(1-10)，comment?，createdAt
- 通知 Reminder：id，appointmentId，triggerAt，channel{in-app}，status{待发送|已发送|失败}

说明：字段以实现为准，上述为建模参考；隐私字段需最小化暴露与加密存储。

## 10. 状态与业务规则
- 预约状态：
  - 待就诊 → 已就诊（医生会诊并完成）
  - 待就诊 → 已退号（患者退号）
- 医生状态：在岗/不在岗；仅在岗时可被预约
- 预约时间约束：只能预约未来 1-7 天
- 注册限制：仅患者可注册；真实姓名作为系统昵称
- 科室删除：需同步清理医生擅长科室关联
- 删除医生：永久删除，不再出现在系统中

## 11. 接口范围示例（草案）
- 认证与用户：
  - POST /auth/patient/register
  - POST /auth/patient/login
  - POST /auth/doctor/login（需校验码）
  - POST /auth/admin/login
  - POST /auth/logout
- 患者功能：
  - GET /departments?query= ；GET /doctors?departmentId= ；GET /schedules?doctorId=&date=
  - POST /appointments（patientId, doctorId, departmentId, visitAt, illnessDesc）
  - PUT /appointments/{id}/reschedule ；DELETE /appointments/{id}
  - GET /appointments/mine ；GET /appointments/{id}/reminder
  - GET /visits/mine ；GET /visits/{id}
  - POST /reviews/doctor ；POST /reviews/department
  - GET/PUT /patients/me（含头像上传）
- 医生功能：
  - GET/PUT /doctors/me ；PUT /doctors/me/status
  - GET /appointments/doctor/mine ；GET /appointments/{id}
  - POST /consultations/{appointmentId}/complete（advice, medsServices[]）
  - PUT /schedules/me
- 管理端：
  - GET/POST/PUT/DELETE /departments
  - GET/POST/PUT/DELETE /doctors（删除为永久）
  - GET /stats/overview ；GET /stats/daily-appointments ；GET /stats/daily-visits
  - GET /rankings/departments ；GET /rankings/doctors
  - GET /admin/records（预约/就诊与人员信息）

注：实际入参、返回体与权限校验需在接口文档中详述。

## 12. 验收标准
- 患者：可完成注册/登录、查询、预约（1-7 天）、退号改签、查看提醒、查看就诊记录详情、评价、维护个人信息
- 医生：可登录（含校验码）、设置在岗/不在岗、查看预约与患者信息、完成会诊并产出就诊记录
- 管理员：可完成科室增删改、医生增改状态删、数据统计、评分排行、预约与就诊信息查询、固定账号登录
- 非功能：主要用户路径平均响应 < 300ms（本地环境），无明显卡顿；数据状态更新前后端一致
- 关闭应用后重新打开必须重新登录

## 13. 安全与合规
- 访问控制：基于角色的访问控制（RBAC）与细粒度鉴权
- 数据保护：口令加密存储、敏感信息脱敏展示；日志不记录隐私明文
- 合规：遵循医疗隐私法规，最小权限原则

## 14. 运行与部署（本地）
- 前端：React 本地启动（开发服务器）
- 后端：Java 21 本地运行
- 数据库：MySQL 8.0（需要修改配置文件中的密码为自己的 MySQL 密码）
- 首次运行需执行 `init_hospital_db.sql` 初始化数据库（包含基础科室：儿科、口腔科、内科、外科）

## 15. 里程碑与交付物（建议）
- M1：基础认证与角色切分、科室初始化、患者查询与预约
- M2：医生在岗/会诊流程、就诊记录与提醒
- M3：管理员科室/医生管理、统计与排行
- M4：评价体系、非功能加固与验收

---

附：本说明书根据 `需求.txt` 拆分整理，后续迭代以评审确认的变更单为准。


